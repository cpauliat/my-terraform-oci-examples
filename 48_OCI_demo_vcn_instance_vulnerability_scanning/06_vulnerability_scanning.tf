

resource oci_vulnerability_scanning_host_scan_recipe tf-demo48-recipe {
  display_name   = "tf-demo48-recipe"
  compartment_id = var.compartment_ocid

  agent_settings {
    scan_level = "STANDARD"     # STANDARD (TOP 1000 ports) or LIGHT (TOP 100 ports) or NONE
      agent_configuration {
        vendor = "OCI"
        cis_benchmark_settings {
          scan_level = "STRICT"             # STRICT, MEDIUM or LIGHTWEIGHT
        }
      }
    }

  port_settings {
    scan_level = "STANDARD"
  }

  schedule {
    type = "DAILY"            # DAILY or WEEKLY
    # day_of_week = "SUNDAY"   # only need for WEEKLY type
  }
}

resource oci_vulnerability_scanning_host_scan_target tf-demo48-target {
  compartment_id        = var.compartment_ocid
  host_scan_recipe_id   = oci_vulnerability_scanning_host_scan_recipe.tf-demo48-recipe.id
  target_compartment_id = var.compartment_ocid

  description = "Demo48 terraform Target for VSS"
  display_name = "tf-demo48-target"

  # Optional: if not set, all instances in compartment will be scanned
  instance_ids = [ oci_core_instance.tf-demo48-ol7.id ]
}